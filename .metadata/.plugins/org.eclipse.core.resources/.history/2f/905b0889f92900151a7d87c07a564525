package main;

class ListNode {
	int val;
	ListNode next;
	ListNode(int x) { val = x; }
}

public class Solution {
	public ListNode reverseKGroup(ListNode head, int k) {
		ListNode newHead = head,oldHead = null, p = null, q = null;
		for(int i = 0 ; i < k-1; i++ ) {
			newHead = newHead.next;
			if(newHead == null)
				return head;
		}
		
		
		
		
		p = head;
		q = p.next;
		//r = q.next;
		
		while(true) {
			for(int i = 0 ; i < k-1; i++) {
				if(i == 0)
					oldHead = p;
				ListNode r = q.next;
				q.next = p;
				p = q;
				q = r;
			}
			
			ListNode nextHead = q;
			for(int i = 0 ; i < k-1; i++) {
				if(nextHead== null)
					return newHead;
				nextHead = nextHead.next;
			}
			
			oldHead.next = nextHead;
			p = q;
			q = q.next;
		}
		
	}
}