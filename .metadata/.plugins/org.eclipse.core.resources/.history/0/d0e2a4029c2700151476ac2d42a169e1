package main;

public class Solution {
	static boolean found;
	
	public static boolean isMatch(String s, String p) {
        
		backtrack(s, "", p, 0);
		
		return found;
    }
	
	public static void backtrack(String s, String part, String pattern, int pos) {
		if(s.equals(part) ){
			if(pos == pattern.length()) {
				found = true;
				return;
			}
			if(pos == pattern.length()-1 && pattern.charAt(pos) == '*') {
				found = true;
				return;
			}
			return;
			
		}
		
		
		
		if(pos >= pattern.length())
			return;
		
		if(pattern.charAt(pos) == s.charAt(part.length())) {
			part = part + s.charAt(part.length());
			backtrack(s, part, pattern, pos+1);
		}
		
		if(pattern.charAt(pos) == '.') {
			part = part + s.charAt(part.length());
			backtrack(s, part, pattern, pos+1);
		}
		
		if(pattern.charAt(pos) == '*') {
			if(pattern.charAt(pos-1) == '.') {
				part = part + s.charAt(part.length());
				backtrack(s, part, pattern, pos);
//				if(s.charAt(part.length()-1) == s.charAt(part.length())) {
//					part = part + s.charAt(part.length());
//					backtrack(s, part, pattern, pos);
//				}
//				else{
//					backtrack(s, part, pattern, pos+1);
//				}
			}
			else {
				if(s.charAt(part.length()) == pattern.charAt(pos-1)) {
					part = part + s.charAt(part.length());
					backtrack(s, part, pattern, pos);
				}
				else {
					backtrack(s, part, pattern, pos+1);
				}
			}
			
		}
		
		
		
		if(pos != pattern.length()-1 && pattern.charAt(pos+1) == '*')
			backtrack(s, part, pattern, pos+1);
		
	}
	
	public static void main(String[] args) {
		String s = "aaa";
		String p = "a*a";
		System.out.println(isMatch(s, p));
	}
}
